---
layout: post
title: "Trapdoor author writeup"
categories: learning
author: s1nn105 
---
A little contribution to revive the KITCTF blog.
## GPNCTF Trapdoor
For GPNCTF I wrote an crypto challenge. It was called trapdoor and at least I thought about using advanced math to solve it. 
The for now relevant part looked like:
The challenge looked as follows:
```py

    flagFieldElem = a^expo
    #all output below here is intended for solve
    print(f"Field Base:{K.base().order()}")
    print(f"Field Expo:{log(K.order(),K.base().order())}")
    print(f"NumElems:{K.cardinality()}")
    print(f"gen:{K.modulus()}")
    minpoly = flagFieldElem.minpoly()
    print(f"Hash is:{minpoly(EVAL_VALUE)}")```
```
The flag was encoded as integer and a group element was generated by computing $$a^{flag}$$ in a Galios Field. 
But what is an galios field, how does it work, and how is it connected to polynomials. 

### Why more math 
Obviously because it is fun. Jokes a aside, you probably know that $$^{\mathbb{Z}}/_{p\mathbb{Z}}$$ is a field if p is a prime. A field in this context means that for all elements (except 0) there is not only an additive but also an multiplicative inverse. And you might have heard you professor or your friends talking about the fact that there are finite fields for each power of a prime. But if you tried construciting such a field with say 25 elements you failed (hopefully), because you just could not find "the right way" to  define your operations: 
Consider "$$^{\mathbb{Z}}/_{2\mathbb{Z}} \times ^{\mathbb{Z}}/_{5\mathbb{Z}}$$. What would be your $$\mathbb{1}$$ element? $$(1,0)$$ or $$(1,1)$$, both won't work (if you dont believe me try to find where, this is a great exercise).

#### Polynomials for the win 
We wont worry  to much about how we can construct such fields in detail. The only thing we need to know for now is that we construct such fields L as  extensions of other fields K. (Written $$L \ K $$)
Meaning we start at an known K  field (e.g GF(5)) and then add new elements,for the sake of simplicity say we only add one element $$a$$, more formal we add elements and then consider the smallest field containing the old field and the elements we newly added.
The incredibly useful thing (at least for computer people) is that 
the newly build field is (at least in our case) then equivalent to $$^{K[X]}/_{(m_a)}$$ where $$m_a \in K[X]$$ is the minimal polynomial of $$a$$ in K[X]. The latter just means that all coefficients of $$m_a$$ are in K (and that it is normed but we dont care about that) and $$m_a(a)=0$$  and the degree of m is minimal.
Cool now we have a way to display such finite fields as polynomials modulu another polynomial.

### How is this related to the challenge ?? 
_Being very "wrong" and impercise for a moment: The thing is we have seen that field extensions are just a fancy way for talking about polynomials and long division. Polynomials are vector spaces and some vector space things can therefore also been done one field extensions_

Consider the map for an $$a \in L$$:
$$L \rightarrow L \\ 
x \mapsto  x \cdot a $$
and consider the determinant of this map this is called the field map $$N_{L\\K}: L \rightarrow k, a \mapsto N_{L\\K}(a)$$
This map has many cool properties like being multiplicative (meaning a homorphism of the unit groups) and if you consider a element $$a \in L$$ with $$m_a = X^n \cdot \alpha_n + ... + \alpha_0$$ then
$$N_{L\\K}(a) = \pm \alpha_0$$ the sign depending on the degree of the extension and the degree of the minimal polynomial. This was one step I had in mind when building the challenge.
Using this and the fact that we have multiple instances we can  decrease the key space enough to iterate the remaining possiblities to find the flag.
